{"ast":null,"code":"import jwt_decode from \"jwt-decode\";\nexport default {\n  name: \"login\",\n\n  data() {\n    return {\n      loginUser: {\n        email: \"\",\n        password: \"\"\n      },\n      rules: {\n        email: [{\n          type: \"email\",\n          required: true,\n          message: \"邮箱格式不正确\",\n          trigger: \"change\"\n        }],\n        password: [{\n          required: true,\n          message: \"密码不能为空\",\n          trigger: \"blur\"\n        }, {\n          min: 6,\n          max: 30,\n          message: \"长度在 6 到 30 个字符\",\n          trigger: \"blur\"\n        }]\n      }\n    };\n  },\n\n  methods: {\n    submitForm(formName) {\n      this.$refs[formName].validate(valid => {\n        if (valid) {\n          this.$axios.post(\"/api/users/login\", this.loginUser).then(res => {\n            // 登录成功\n            const {\n              token\n            } = res.data;\n            localStorage.setItem(\"eleToken\", token); // 解析token\n\n            const decode = jwt_decode(token); // 存储数据\n\n            this.$store.dispatch(\"setIsAutnenticated\", !this.isEmpty(decode));\n            this.$store.dispatch(\"setUser\", decode); // 页面跳转\n\n            this.$router.push(\"/index\");\n          });\n        } else {\n          console.log(\"error submit!!\");\n          return false;\n        }\n      });\n    },\n\n    isEmpty(value) {\n      return value === undefined || value === null || typeof value === \"object\" && Object.keys(value).length === 0 || typeof value === \"string\" && value.trim().length === 0;\n    }\n\n  }\n};","map":{"version":3,"mappings":"AAyBA;AAEA;EACAA,aADA;;EAEAC;IACA;MACAC;QACAC,SADA;QAEAC;MAFA,CADA;MAKAC;QACAF,QACA;UACAG,aADA;UAEAC,cAFA;UAGAC,kBAHA;UAIAC;QAJA,CADA,CADA;QASAL,WACA;UAAAG;UAAAC;UAAAC;QAAA,CADA,EAEA;UAAAC;UAAAC;UAAAH;UAAAC;QAAA,CAFA;MATA;IALA;EAoBA,CAvBA;;EAwBAG;IACAC;MACA;QACA;UACA;YACA;YACA;cAAAC;YAAA;YACAC,wCAHA,CAKA;;YACA,iCANA,CAQA;;YACA;YACA,wCAVA,CAYA;;YACA;UACA,CAdA;QAeA,CAhBA,MAgBA;UACAC;UACA;QACA;MACA,CArBA;IAsBA,CAxBA;;IAyBAC;MACA,OACAC,uBACAA,cADA,IAEA,4DAFA,IAGA,sDAJA;IAMA;;EAhCA;AAxBA","names":["name","data","loginUser","email","password","rules","type","required","message","trigger","min","max","methods","submitForm","token","localStorage","console","isEmpty","value"],"sourceRoot":"src/views","sources":["Login.vue"],"sourcesContent":["<template>\n    <div class=\"login\">\n        <section class=\"form_container\">\n            <div class=\"manage_tip\">\n                <span class=\"title\">米修在线后台管理系统</span>\n            </div>\n            <el-form :model=\"loginUser\" :rules=\"rules\" ref=\"loginForm\" class=\"loginForm\" label-width=\"60px\">\n                <el-form-item label=\"邮箱\" prop=\"email\">\n                    <el-input v-model=\"loginUser.email\" placeholder=\"请输入邮箱\"></el-input>\n                </el-form-item>\n                <el-form-item label=\"密码\" prop=\"password\">\n                    <el-input v-model=\"loginUser.password\" placeholder=\"请输入密码\" type=\"password\"></el-input>\n                </el-form-item>\n                <el-form-item>\n                    <el-button type=\"primary\"  @click=\"submitForm('loginForm')\" class=\"submit_btn\">登  录</el-button>\n                </el-form-item>\n                <div class=\"tiparea\">\n                    <p>还没有账号？现在<router-link to='/register'>注册</router-link></p>\n                </div>\n            </el-form>\n        </section>\n    </div>\n</template>\n\n<script>\nimport jwt_decode from \"jwt-decode\";\n\nexport default {\n  name: \"login\",\n  data() {\n    return {\n      loginUser: {\n        email: \"\",\n        password: \"\"\n      },\n      rules: {\n        email: [\n          {\n            type: \"email\",\n            required: true,\n            message: \"邮箱格式不正确\",\n            trigger: \"change\"\n          }\n        ],\n        password: [\n          { required: true, message: \"密码不能为空\", trigger: \"blur\" },\n          { min: 6, max: 30, message: \"长度在 6 到 30 个字符\", trigger: \"blur\" }\n        ]\n      }\n    };\n  },\n  methods: {\n    submitForm(formName) {\n      this.$refs[formName].validate(valid => {\n        if (valid) {\n          this.$axios.post(\"/api/users/login\", this.loginUser).then(res => {\n            // 登录成功\n            const { token } = res.data;\n            localStorage.setItem(\"eleToken\", token);\n\n            // 解析token\n            const decode = jwt_decode(token);\n\n            // 存储数据\n            this.$store.dispatch(\"setIsAutnenticated\", !this.isEmpty(decode));\n            this.$store.dispatch(\"setUser\", decode);\n\n            // 页面跳转\n            this.$router.push(\"/index\");\n          });\n        } else {\n          console.log(\"error submit!!\");\n          return false;\n        }\n      });\n    },\n    isEmpty(value) {\n      return (\n        value === undefined ||\n        value === null ||\n        (typeof value === \"object\" && Object.keys(value).length === 0) ||\n        (typeof value === \"string\" && value.trim().length === 0)\n      );\n    }\n  }\n};\n</script>\n\n<style scoped>\n.login {\n  position: relative;\n  width: 100%;\n  height: 100%;\n  background: url(../assets/bg.jpg) no-repeat center center;\n  background-size: 100% 100%;\n}\n.form_container {\n  width: 370px;\n  height: 210px;\n  position: absolute;\n  top: 20%;\n  left: 34%;\n  padding: 25px;\n  border-radius: 5px;\n  text-align: center;\n}\n.form_container .manage_tip .title {\n  font-family: \"Microsoft YaHei\";\n  font-weight: bold;\n  font-size: 26px;\n  color: #fff;\n}\n.loginForm {\n  margin-top: 20px;\n  background-color: #fff;\n  padding: 20px 40px 20px 20px;\n  border-radius: 5px;\n  box-shadow: 0px 5px 10px #cccc;\n}\n\n.submit_btn {\n  width: 100%;\n}\n.tiparea {\n  text-align: right;\n  font-size: 12px;\n  color: #333;\n}\n.tiparea p a {\n  color: #409eff;\n}\n</style>\n\n\n"]},"metadata":{},"sourceType":"module"}